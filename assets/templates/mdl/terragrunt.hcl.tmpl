include {
  path = find_in_parent_folders()
}

locals {
  prj_cfg    = read_terragrunt_config(find_in_parent_folders("prj.hcl"))
  env_cfg    = read_terragrunt_config(find_in_parent_folders("env.hcl"))
  region_cfg = read_terragrunt_config(find_in_parent_folders("region.hcl"))
  
  
  name = "{{.Scaffold.Name}}"
  prj_name = prj_cfg.locals.name
  prj_slug_name = prj_slug_name
  stack = stack
  environment = environment    
  
  library = local.env_cfg.library
  library_version = local.env_cfg.library_version
  module = "{{.Module}}"
  
  tf_module_source = "${local.library}//${local.module}?ref=${local.library_version}"
}

terraform {
  source = local.tf_module_source
}

inputs = {
  metadata = local.metadata
}
